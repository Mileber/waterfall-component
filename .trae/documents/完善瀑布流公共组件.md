## 目标
在不改变现有对外行为的前提下，统一并增强 Vue2/3 双版本瀑布流组件的 API、类型与导出；提升布局算法的可配置性与鲁棒性；优化虚拟化性能；补齐 SSR 保护、可访问性、主题化、文档、打包与测试/CI。

## API 统一与增强
- 统一 Vue2/3 Props 与命名；新增 `overscan`、`bufferFactor`、`minRowFillRatio`、`onRenderStart/onRenderEnd/onError/onResize` 事件
- 明确 `items` 结构标准（必须有 `cover` 或 `width/height`），完善空值与错误处理策略
- 为 `IntersectionObserver` 加入 `root`、`rootMargin`、`threshold` 可配置项

## 类型与导出
- 生成并对齐 `dist/index.d.ts`，补充事件/插槽上下文类型
- 在包级 `package.json` 增加 `exports` 与 `sideEffects` 字段，优化 ESM/CJS 解析与摇树
- 将 `shared/layout.ts` 的类型与函数通过统一入口导出，形成公共算法层

## 布局算法增强
- 横向（`justified`）：加入最后一行保留阈值（`minRowFillRatio`）、对齐模式（居左/居中/拉伸）、极端宽高比保护
- 纵向（`masonryVertical`）：支持固定列数/自适应切换、列高度平滑策略、批量更新减少回流
- 为两算法补充边界与性能测试

## 虚拟化与性能
- 将 `visibleItems` 改为索引分区/行列分桶过滤，降低线性扫描成本
- 图片加载并发限制与取消（AbortController），错误重试策略与占位图配置
- 为滚动与 resize 的防抖/节流提供可调参数；合并测量与布局批次

## 响应式与 SSR 保护
- 在访问 `window/document/Image` 前做环境判断，提供 SSR 安全占位与挂载后激活
- 维持滚动位置并做增量重排；resize 后保留分页之前的数据布局

## 可访问性
- 容器/项加入 `role="list"`/`role="listitem"`，建议/强制 `alt`；键盘导航与焦点管理
- 文档中给出无障碍使用示例

## 主题化与样式接口
- 抽取 CSS 变量（如 `--wf-gutter`、阴影、hover 动效），允许传入 `class`/`style` 或 `theme` 对象
- 保持样式隔离且可被覆盖；评估 `sideEffects` 与样式保留策略

## 文档与示例完善
- 在 README 完整列出 Props/事件/类型，增加横纵向、不同宽高比、无限滚动、固定列数等示例
- 示例从源码直引改为从打包产物引入，验证发布使用路径

## 打包与发布配置
- Rollup 保持 `external: ['vue']`；补充 `exports` 字段与类型映射
- 为 Vue2/3 包声明 `sideEffects`；准备 `npm publish --dry-run` 检查脚本

## 测试与 CI
- 单元：布局算法（宽高比边界、最后行策略）、可见区计算、事件触发、错误图片占位
- 组件：滚动/resize/IntersectionObserver 回退逻辑、分页与容器高度更新
- 集成：示例页面加载更多闭环、打包后导入
- CI：GitHub Actions/GitLab CI 执行 build/test/lint/type-check 与发布预检

请确认以上改造方向与范围；确认后我将按模块分支实施并逐步提交改动与测试。